repos:
    # Detect Secrets
    - repo: https://github.com/Yelp/detect-secrets
      rev: v1.4.0
      hooks:
        - id: detect-secrets
          args: ["--exclude-lines", "SECRET_PREFIX = 'secret:'|.*secretsmanager:GetSecretValue.*", "--exclude-secrets", ".*fake-secret.*|.*fake-password.*|.*FAKE_SECRET.*"]
          stages: [commit]
    
    # Python Linting using Ruff & Flake8
    - repo: https://github.com/astral-sh/ruff-pre-commit
      rev: v0.4.7
      hooks:
        - id: ruff
          types_or: [ python, pyi, jupyter ]
          args: []  # [ --fix ]
          stages: [push]
        # - id: ruff-format
        #  types_or: [ python, pyi, jupyter ]
        #  stages: [push]

    - repo: https://github.com/pycqa/flake8
      rev: 7.0.0
      hooks:
        - id: flake8
          stages: [push]

    # Terrafmorm
    # - repo: local
    #   hooks:
    #     - id: terraform-init-no-backend  # Needed for terraform validate
    #       name: terraform-init-without-backend
    #       # entry: bash -c ' && terraform init -backend=false && cd ../staging && terraform init -backend=false && cd ../prod && terraform init -backend=false'
    #       entry: bash -c 'terraform -chdir=environments/dev validate && terraform -chdir=infra/terraform/environments/staging validate && terraform -chdir=infra/terraform/environments/prod validate '
    #       language: system
    #       stages: [push]

    - repo: https://github.com/terraform-docs/terraform-docs
      rev: v0.18.0
      hooks:
        - id: terraform-docs-go
          # args: ["markdown", "table", "--recursive", "true", "--recursive-include-main", "false", "output-file", "README.md", "./infra/terraform/environments/prod"]
          args: ["markdown", "table", "--recursive", "--recursive-include-main=false", "--output-file", "README.md", "./infra/terraform"]
          stages: [commit]
          
    - repo: https://github.com/antonbabenko/pre-commit-terraform
      rev: v1.91.0
      hooks:
        - id: terraform_fmt
          stages: [push]
        #- id: terraform_tflint  TODO (@limorl): Install TFLint in docker and enable this hook
        #  stages: [push]
        - id: terraform_validate
          args:
            - --tf-init-args=-backend=false
           # - --chdir=infra/terraform
          stages: [push]
        #- id: terraform_docs     TODO (@limorl): Install TFLint in docker and enable this hook omstead of terraform-docs-go
        #  stages: [push]

    - repo: local
      hooks:
        - id: terraform-validate-all
          name: terraform-validate-all
          entry: bash .github/scripts/terraform-validate-all.sh
          language: system
          stages: [push]

    # Spell Checking
    - repo: https://github.com/codespell-project/codespell
      rev: v2.2.4
      hooks:
      - id: codespell
        name: codespell
        description: Checks for common misspellings in text files.
        entry: codespell
        language: python
        types: [text]
        stages: [push]

    - repo: local
      hooks:
        - id: unit-tests
          name: unit-tests
          entry: python run_script.py pytest-impacted-only
          language: system
          stages: [push]
          pass_filenames: false
